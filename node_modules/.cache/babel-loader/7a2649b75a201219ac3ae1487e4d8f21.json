{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar echarts = require(\"echarts\");\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\nfunction isEmptyObject(obj) {\n  for (var key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nvar _default = echarts.extendComponentView({\n  type: 'bmap',\n  render: function (bMapModel, ecModel, api) {\n    var rendering = true;\n    var bmap = bMapModel.getBMap();\n    var viewportRoot = api.getZr().painter.getViewportRoot();\n    var coordSys = bMapModel.coordinateSystem;\n\n    var moveHandler = function (type, target) {\n      if (rendering) {\n        return;\n      }\n\n      var offsetEl = viewportRoot.parentNode.parentNode.parentNode;\n      var mapOffset = [-parseInt(offsetEl.style.left, 10) || 0, -parseInt(offsetEl.style.top, 10) || 0];\n      viewportRoot.style.left = mapOffset[0] + 'px';\n      viewportRoot.style.top = mapOffset[1] + 'px';\n      coordSys.setMapOffset(mapOffset);\n      bMapModel.__mapOffset = mapOffset;\n      api.dispatchAction({\n        type: 'bmapRoam'\n      });\n    };\n\n    function zoomEndHandler() {\n      if (rendering) {\n        return;\n      }\n\n      api.dispatchAction({\n        type: 'bmapRoam'\n      });\n    }\n\n    bmap.removeEventListener('moving', this._oldMoveHandler);\n    bmap.removeEventListener('moveend', this._oldMoveHandler);\n    bmap.removeEventListener('zoomend', this._oldZoomEndHandler);\n    bmap.addEventListener('moving', moveHandler);\n    bmap.addEventListener('moveend', moveHandler);\n    bmap.addEventListener('zoomend', zoomEndHandler);\n    this._oldMoveHandler = moveHandler;\n    this._oldZoomEndHandler = zoomEndHandler;\n    var roam = bMapModel.get('roam');\n\n    if (roam && roam !== 'scale') {\n      bmap.enableDragging();\n    } else {\n      bmap.disableDragging();\n    }\n\n    if (roam && roam !== 'move') {\n      bmap.enableScrollWheelZoom();\n      bmap.enableDoubleClickZoom();\n      bmap.enablePinchToZoom();\n    } else {\n      bmap.disableScrollWheelZoom();\n      bmap.disableDoubleClickZoom();\n      bmap.disablePinchToZoom();\n    }\n    /* map 2.0 */\n\n\n    var originalStyle = bMapModel.__mapStyle;\n    var newMapStyle = bMapModel.get('mapStyle') || {}; // FIXME, Not use JSON methods\n\n    var mapStyleStr = JSON.stringify(newMapStyle);\n\n    if (JSON.stringify(originalStyle) !== mapStyleStr) {\n      // FIXME May have blank tile when dragging if setMapStyle\n      if (!isEmptyObject(newMapStyle2)) {\n        bmap.setMapStyle(echarts.util.clone(newMapStyle));\n      }\n\n      bMapModel.__mapStyle = JSON.parse(mapStyleStr);\n    }\n    /* map 3.0 */\n\n\n    var originalStyle2 = bMapModel.__mapStyle2;\n    var newMapStyle2 = bMapModel.get('mapStyleV2') || {}; // FIXME, Not use JSON methods\n\n    var mapStyleStr2 = JSON.stringify(newMapStyle2);\n\n    if (JSON.stringify(originalStyle2) !== mapStyleStr2) {\n      // FIXME May have blank tile when dragging if setMapStyle\n      if (!isEmptyObject(newMapStyle2)) {\n        bmap.setMapStyleV2(echarts.util.clone(newMapStyle2));\n      }\n\n      bMapModel.__mapStyle2 = JSON.parse(mapStyleStr2);\n    }\n\n    rendering = false;\n  }\n});\n\nmodule.exports = _default;","map":{"version":3,"names":["echarts","require","isEmptyObject","obj","key","hasOwnProperty","_default","extendComponentView","type","render","bMapModel","ecModel","api","rendering","bmap","getBMap","viewportRoot","getZr","painter","getViewportRoot","coordSys","coordinateSystem","moveHandler","target","offsetEl","parentNode","mapOffset","parseInt","style","left","top","setMapOffset","__mapOffset","dispatchAction","zoomEndHandler","removeEventListener","_oldMoveHandler","_oldZoomEndHandler","addEventListener","roam","get","enableDragging","disableDragging","enableScrollWheelZoom","enableDoubleClickZoom","enablePinchToZoom","disableScrollWheelZoom","disableDoubleClickZoom","disablePinchToZoom","originalStyle","__mapStyle","newMapStyle","mapStyleStr","JSON","stringify","newMapStyle2","setMapStyle","util","clone","parse","originalStyle2","__mapStyle2","mapStyleStr2","setMapStyleV2","module","exports"],"sources":["D:/vue/Mao/node_modules/echarts/extension/bmap/BMapView.js"],"sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar echarts = require(\"echarts\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nfunction isEmptyObject(obj) {\n  for (var key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nvar _default = echarts.extendComponentView({\n  type: 'bmap',\n  render: function (bMapModel, ecModel, api) {\n    var rendering = true;\n    var bmap = bMapModel.getBMap();\n    var viewportRoot = api.getZr().painter.getViewportRoot();\n    var coordSys = bMapModel.coordinateSystem;\n\n    var moveHandler = function (type, target) {\n      if (rendering) {\n        return;\n      }\n\n      var offsetEl = viewportRoot.parentNode.parentNode.parentNode;\n      var mapOffset = [-parseInt(offsetEl.style.left, 10) || 0, -parseInt(offsetEl.style.top, 10) || 0];\n      viewportRoot.style.left = mapOffset[0] + 'px';\n      viewportRoot.style.top = mapOffset[1] + 'px';\n      coordSys.setMapOffset(mapOffset);\n      bMapModel.__mapOffset = mapOffset;\n      api.dispatchAction({\n        type: 'bmapRoam'\n      });\n    };\n\n    function zoomEndHandler() {\n      if (rendering) {\n        return;\n      }\n\n      api.dispatchAction({\n        type: 'bmapRoam'\n      });\n    }\n\n    bmap.removeEventListener('moving', this._oldMoveHandler);\n    bmap.removeEventListener('moveend', this._oldMoveHandler);\n    bmap.removeEventListener('zoomend', this._oldZoomEndHandler);\n    bmap.addEventListener('moving', moveHandler);\n    bmap.addEventListener('moveend', moveHandler);\n    bmap.addEventListener('zoomend', zoomEndHandler);\n    this._oldMoveHandler = moveHandler;\n    this._oldZoomEndHandler = zoomEndHandler;\n    var roam = bMapModel.get('roam');\n\n    if (roam && roam !== 'scale') {\n      bmap.enableDragging();\n    } else {\n      bmap.disableDragging();\n    }\n\n    if (roam && roam !== 'move') {\n      bmap.enableScrollWheelZoom();\n      bmap.enableDoubleClickZoom();\n      bmap.enablePinchToZoom();\n    } else {\n      bmap.disableScrollWheelZoom();\n      bmap.disableDoubleClickZoom();\n      bmap.disablePinchToZoom();\n    }\n    /* map 2.0 */\n\n\n    var originalStyle = bMapModel.__mapStyle;\n    var newMapStyle = bMapModel.get('mapStyle') || {}; // FIXME, Not use JSON methods\n\n    var mapStyleStr = JSON.stringify(newMapStyle);\n\n    if (JSON.stringify(originalStyle) !== mapStyleStr) {\n      // FIXME May have blank tile when dragging if setMapStyle\n      if (!isEmptyObject(newMapStyle2)) {\n        bmap.setMapStyle(echarts.util.clone(newMapStyle));\n      }\n\n      bMapModel.__mapStyle = JSON.parse(mapStyleStr);\n    }\n    /* map 3.0 */\n\n\n    var originalStyle2 = bMapModel.__mapStyle2;\n    var newMapStyle2 = bMapModel.get('mapStyleV2') || {}; // FIXME, Not use JSON methods\n\n    var mapStyleStr2 = JSON.stringify(newMapStyle2);\n\n    if (JSON.stringify(originalStyle2) !== mapStyleStr2) {\n      // FIXME May have blank tile when dragging if setMapStyle\n      if (!isEmptyObject(newMapStyle2)) {\n        bmap.setMapStyleV2(echarts.util.clone(newMapStyle2));\n      }\n\n      bMapModel.__mapStyle2 = JSON.parse(mapStyleStr2);\n    }\n\n    rendering = false;\n  }\n});\n\nmodule.exports = _default;"],"mappings":"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"},"metadata":{},"sourceType":"script"}